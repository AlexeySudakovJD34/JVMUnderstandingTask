# Задача "Понимание JVM"

## Код для исследования
```java

public class JvmComprehension {

    public static void main(String[] args) {
        int i = 1;                      // 1
        Object o = new Object();        // 2
        Integer ii = 2;                 // 3
        printAll(o, i, ii);             // 4
        System.out.println("finished"); // 7
    }

    private static void printAll(Object o, int i, Integer ii) {
        Integer uselessVar = 700;                   // 5
        System.out.println(o.toString() + i + ii);  // 6
    }
}

```
## Описание процессов "под капотом" JVM

### Работа ClassLoader'ов (загрузка информации о классах программы в область памяти Metaspace)

- Application CL делегирует загрузку классов в Platform CL, а Platform CL делегирует в Bootstrap CL;
- Bootstrap CL подгружает системные классы: Object.class, Integer.class, System.class;
- Далее должен отработать Platform CL, но он отдыхает, так как классов java.util в коде нет;
- Application CL загружает в Metaspace класс JvmComprehension.class;
- После загрузки классов (Loading) выполняется их подготовка (Linking) и инициализация (Initialization).

### Области памяти
 
- Метаданные о классах загрузились в Metaspace;
- На дне стэка формируется фрейм метода main();
- // 1: в области фрейма метода main() в стэке выделяется память для переменной int i = 1;
- // 2: в куче выделяется память для объекта класса Object (размер соответствует метаданным о классе из Metaspace), стартером создания объекта класса Object является "new";
- В фрейме main() в стэке формируется переменная Object o, содержащая ссылку на соответствующий объект в куче;
- // 3: в куче выделяется память для объекта класса Integer (размер соответствует метаданным о классе из Metaspace), в поле объекта помещается значение 2;
- В фрейме main() в стэке формируется переменная Integer ii, содержащая ссылку на соответствующий объект в куче;
- // 4: фрейм main() закрывается и над ним создается новый фрейм printALL(), в котором по аналогии с фреймом main() создаются переменные Object o, Integer ii - которым передаются значения ссылок на объекты в куче, а также int i, которой передается значение 2;
- // 5: в куче выделяется память для объекта класса Integer (размер соответствует метаданным о классе из Metaspace), в поле объекта помещается значение 700;
- В фрейме printAll в стэке формируется переменная Integer uselessVar, содержащая ссылку на соответствующий объект в куче;
- // 6: в куче выделяется память для объекта класса System, закрывается фрейм printAll() в стэке, над ним открывается фрейм метода out.println() класса System;
- В этом фрейме две ссылочные переменные (o, ii) и одна примитивная (i);
- Фрейм out.println() удаляется из стэка;
- Фрейм printAll() удаляется из стэка, мы вернулись в фрейм main();
- // 7: в куче выделяется память для объекта класса System, закрывается фрейм main() в стэке, над ним открывается фрейм метода out.println() класса System, в этом фрейме нет переменных;
- Фрейм out.println() удаляется из стэка;
- Фрейм main() удаляется из стэка. 
 
### Сборщик мусора
- сборщик мусора удалит объекты из кучи после завершения выполнения программы.